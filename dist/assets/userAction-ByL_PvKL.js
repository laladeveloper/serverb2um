import{M as u,N as g,O as l,Q as i,e as f,S as m,T as S,U as n,V as y,W as w,X as p,Y as d,Z as O}from"./index-ChFFMl3H.js";const c="",M=o=>async r=>{try{r(d());const s=await(await fetch(`${c}/api/user/new`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).json();if(s&&localStorage.setItem("user",JSON.stringify(s)),s.success)return r(O(s)),s;throw r(n(s)),new Error(s.message)}catch(e){r(n(e))}},N=(o,r)=>async e=>{try{e(u());const s=await fetch(`${c}/api/user/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:o,password:r})}),a=await s.json();if(console.log(JSON.stringify(a)),console.log(a),a.success===!0)return localStorage.setItem("user",JSON.stringify(a)),e(g(a)),a;if(s.status===401){const t={success:!1,message:"Invalid username or password"};e(l(a));return}}catch(s){console.log(s),e(l({success:!1,message:"Invalid username or password"}))}},U=(o,r)=>async e=>{try{e(i());const s={headers:{Authorization:`Bearer ${o}`}},t=await(await f.put(`${c}/api/user/me`,r,s)).data;if(t&&(localStorage.removeItem("user"),localStorage.setItem("user",JSON.stringify(t))),t.success)return localStorage.removeItem("user"),localStorage.setItem("user",JSON.stringify(t)),e(m(t)),t;throw e(S(t)),new Error(t.message)}catch(s){e(n(s))}},J=()=>async o=>{try{o(y()),o(w({success:!0,message:"Logged out Successful"})),localStorage.removeItem("user")}catch(r){console.log(r),o(p({success:!1,message:"Logout Failed. Please try again later"}))}};export{J as a,N as l,M as r,U as u};
